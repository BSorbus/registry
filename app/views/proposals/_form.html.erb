<%= javascript_include_tag "proposal_area_is_required" %>

<div class="row">
  <div class="col-sm-12">

    <%= form_with(model: proposal, url: { action: "#{proposal.new_record? ? 'create' : 'update'}", service_type: params[:service_type] }, local: true) do |f| %>

      <% input_disabled ||= false %>

      <%= form_errors_for proposal %>

      <div class="row">
        <div class="col-sm-6">

          <div class="row">

            <div class="form-group required col-sm-4">
              <%= f.label :insertion_date, class: 'control-label' %>
              <%= f.text_field :insertion_date, class: 'form-control input-sm datepicker', 
                                disabled: false %>
            </div>

            <div class="form-group required col-sm-4">
              <%= f.label :proposal_type_id, class: 'control-label' %>
              <%= f.select :proposal_type_id, 
                    ProposalType.all.collect {|v| [ "#{v[:name]}", v[:id] ] },
                    { include_blank: false }, 
                    { autofocus: false, class: 'form-control input-sm', disabled: false } %>
            </div>

            <div class="form-group required col-sm-4">
              <%= f.label :proposal_status_id, class: 'control-label' %>
              <%= f.select :proposal_status_id, 
                    ProposalStatus.all.collect {|v| [ "#{v[:name]}", v[:id] ] },
                    { include_blank: false }, 
                    { autofocus: false, class: 'form-control input-sm', disabled: false } %>
            </div>
          </div>  <!-- /row -->

        </div>  <!-- /col-sm-6 -->

        <div class="col-sm-6">

          <div class="row">
            <div class="form-group col-sm-12">
              <%= f.label :note, class: 'control-label' %>
              <%= f.trix_editor :note %>
              <%#= f.text_area :note, :rows => 4, class: 'form-control input-sm' %>
            </div>
          </div>  <!-- /row -->
          
        </div>  <!-- /col-sm-6 -->
      </div>  <!-- /row -->

      <div class="row">
        <div class="col-sm-12">
          <fieldset class="my-fieldset">
            <legend class="my-fieldset"><%= t('proposals.fieldset.proposal_networks_title') %></legend>

            <div class='proposal_networks_title clearfix'>

              <div class='proposal_proposal_networks-sub-form'>
                <%= f.fields_for :proposal_networks do |proposal_proposal_network_form|  %>
                  <%= render 'proposal_networks/proposal_network_fields', f: proposal_proposal_network_form if (FeatureType.only_network_type.ids.include?(proposal_proposal_network_form.object.network_type_id) ) %> 
                <% end %>
              </div>
              <%= link_to_add_fields( t("helpers.links.link_to_add_fields_nested"), f, :proposal_networks, 'proposal_networks/proposal_network_fields') %>

            </div>

          </fieldset>
        </div> <!--/col-sm-12 -->
        
      </div>  <!-- /row -->


      <div class="row">

        <div class="col-sm-12">

          <div class="row">
            <div class="col-sm-12">
              <fieldset class="my-fieldset">
                <legend class="my-fieldset"><%= t('proposals.fieldset.proposal_area_title') %></legend>

                <div class="row">
                  <div class="form-group col-sm-12">
                    <%= f.label :activity_area_whole_poland, class: 'control-label' %><br>
                    <%= f.radio_button(:activity_area_whole_poland, true, disabled: false, onchange: "proposalAreIsRequired(this.value, this)") %>
                    <%= f.label(:activity_area_whole_poland_true, t("true") ) %>
                    <%= f.radio_button(:activity_area_whole_poland, false, disabled: false, onchange: "proposalAreIsRequired(this.value, this)") %>
                    <%= f.label(:activity_area_whole_poland_false, t("false") ) %>
                  </div>
                </div>

                <div class="row">
                  <div class="col-sm-11 col-sm-offset-1">

                    <div class='proposal_area_enabled_disabled'>
                      <div class='proposal_areas_title clearfix'>
                        <fieldset class="my-fieldset">
                        <legend class="my-fieldset"><%= t('proposals.fieldset.proposal_another_areas_title')%></legend>
                          <!-- header for partial -->
                          <div class="row" >
                            <div class="form-group required col-sm-3">
                              <strong><%= ProposalArea.human_attribute_name(:province_name) %></strong>
                            </div>
                            <div class="form-group required col-sm-3">
                              <strong><%= ProposalArea.human_attribute_name(:district_name) %></strong>
                            </div>
                            <div class="form-group required col-sm-4">
                              <strong><%= ProposalArea.human_attribute_name(:commune_name) %></strong>
                            </div>
                          </div>

                          <div class='proposal_proposal_areas-sub-form'>
                            <%= f.fields_for :proposal_areas do |proposal_proposal_area_form|  %>
                              <%= render 'proposal_areas/proposal_area_fields', f: proposal_proposal_area_form %> 
                            <% end %>
                          </div>
                          <%= link_to_add_fields( t("helpers.links.link_to_add_fields_nested"), f, :proposal_areas, 'proposal_areas/proposal_area_fields') %>

                        </fieldset>

                      </div>
                    </div>
                  </div>
                </div>

              </fieldset>
            </div>
          </div>
        </div>

      </div>  <!-- /row -->


      <div class="row">
        <div class="col-sm-4">
          <fieldset class="my-fieldset-short">
            <legend class="my-fieldset"><%= t('proposals.fieldset.proposal_scheduled_title') %></legend>

            <div class="row">

              <div class="form-group required col-sm-6">
                <%= f.label :scheduled_start_date, class: 'control-label' %>
                <%= f.text_field :scheduled_start_date, class: 'form-control input-sm datepicker', 
                                  disabled: false %>
              </div>

              <div class="form-group col-sm-6">
                <%= f.label :scheduled_end_date, class: 'control-label' %>
                <%= f.text_field :scheduled_end_date, class: 'form-control input-sm datepicker', 
                                  disabled: false %>
              </div>

            </div> <!--/row -->

          </fieldset>
        </div>

      </div>  <!-- /row -->




      <hr class="hr-with-minimum-margins">

      <div class="row">
        <div class="col-sm-12">

          <%= link_to proposal.new_record? ? proposals_path(param[:service_type]) : proposal_path(proposal.service_type, proposal), class: "btn btn-default" do %>
            <%= back_from_new_or_edit_legend %>
          <% end %>

          <%= f.submit nil, class: 'btn btn-success' %>

        </div> <!--/col-sm-12 -->
      </div> <!-- /row -->
      
    <% end %>

  </div> <!--/col-sm-12-->
</div>


<div id="myModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content"></div>
  </div>
</div>

<script type="text/javascript">

  console.log('Aaaaaaaaaaaaaaaaaa');

  var areaState = "<%= proposal.activity_area_whole_poland %>";

  console.log(areaState);
  
  proposalAreIsRequired(areaState, null);


</script>