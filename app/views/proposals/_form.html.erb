<div class="row">
  <div class="col-sm-12">

    <%= form_with(model: proposal, url: { action: "#{proposal.new_record? ? 'create' : 'update'}", service_type: params[:service_type] }, local: true) do |f| %>

      <% input_disabled ||= false %>

      <%= form_errors_for proposal %>

      <div class="row">
        <div class="col-sm-7">

          <div class="row">
            <div class="form-group required col-sm-4">
              <%= f.label :insertion_date, class: 'control-label' %>
              <%= f.text_field :insertion_date, class: 'form-control input-sm datepicker', 
                                disabled: false %>
            </div>

            <div class="form-group required col-sm-4">
              <%= f.label :proposal_type_id, class: 'control-label' %>
              <%= f.select :proposal_type_id, 
                    ProposalType.all.collect {|v| [ "#{v[:name]}", v[:id] ] },
                    { include_blank: false }, 
                    { autofocus: false, class: 'form-control input-sm', disabled: false } %>
            </div>

            <div class="form-group required col-sm-4">
              <%= f.label :proposal_status_id, class: 'control-label' %>
              <%= f.select :proposal_status_id, 
                    ProposalStatus.all.collect {|v| [ "#{v[:name]}", v[:id] ] },
                    { include_blank: false }, 
                    { autofocus: false, class: 'form-control input-sm', disabled: false } %>
            </div>
          </div>  <!-- /row -->

          <div class="row">
            <div class="form-group required col-sm-12">
              <%= f.label :organization_id, class: 'control-label' %>
              <%= f.hidden_field :organization_id, 
                                class: "form-control input-sm select2organization", 
                                placeholder: t('placeholder.select2organization'),
                                style: "width:100%",
                                "data-locale": "#{params[:locale]}" %>
            </div>
          </div>

        </div>  <!-- /col-sm-7 -->

        <div class="col-sm-5">

          <div class="row">
            <div class="form-group col-sm-12">
              <%= f.label :note, class: 'control-label' %>
              <%= f.trix_editor :note %>
              <%#= f.text_area :note, :rows => 4, class: 'form-control input-sm' %>
            </div>
          </div>  <!-- /row -->
          
        </div>  <!-- /col-sm-5 -->
      </div>  <!-- /row -->

      <%= render "form_#{proposal.service_type}", f: f %>

      <%= render "form_areas", f: f if ['j','t'].include?(proposal.service_type) %>

      <div class="row">
        <div class="col-sm-4">
          <fieldset class="my-fieldset-short">
            <legend class="my-fieldset"><%= t('proposals.fieldset.proposal_scheduled_title') %></legend>

            <div class="row">

              <div class="form-group required col-sm-6">
                <%= f.label :scheduled_start_date, class: 'control-label' %>
                <%= f.text_field :scheduled_start_date, class: 'form-control input-sm datepicker', 
                                  disabled: false %>
              </div>

              <div class="form-group col-sm-6">
                <%= f.label :scheduled_end_date, class: 'control-label' %>
                <%= f.text_field :scheduled_end_date, class: 'form-control input-sm datepicker', 
                                  disabled: false %>
              </div>

            </div> <!--/row -->

          </fieldset>
        </div>

        <div class="col-sm-8">
          <fieldset class="my-fieldset">
            <legend class="my-fieldset"><%= t('proposals.fieldset.proposal_attachments_title') %></legend>

            <div class='proposal_attachments_title clearfix'>

              <!-- header for partial -->
              <div class="row" >
                <div class="form-group required col-sm-5">
                  <strong><%= ProposalAttachment.human_attribute_name(:attachment_type) %></strong>
                </div>
                <div class="form-group required col-sm-6">
                  <strong><%= ProposalAttachment.human_attribute_name(:attached_pdf_file) %></strong>
                </div>
              </div>

              <div class='proposal_proposal_attachments-sub-form'>
                <%= f.fields_for :proposal_attachments do |proposal_proposal_attachment_form|  %>
                  <%= render 'proposal_attachments/proposal_attachment_fields', f: proposal_proposal_attachment_form %> 
                <% end %>
              </div>
              <%= link_to_add_fields( t("helpers.links.link_to_add_fields_nested"), f, :proposal_attachments, 'proposal_attachments/proposal_attachment_fields') %>

            </div>

          </fieldset>
        </div> <!--/col-sm-12 -->


      </div>  <!-- /row -->




      <hr class="hr-with-minimum-margins">

      <div class="row">
        <div class="col-sm-12">

          <%= link_to proposal.new_record? ? proposals_path(params[:service_type]) : proposal_path(proposal.service_type, proposal), class: "btn btn-default" do %>
            <%= back_from_new_or_edit_legend %>
          <% end %>

          <%= f.submit nil, class: 'btn btn-success' %>

        </div> <!--/col-sm-12 -->
      </div> <!-- /row -->
      
    <% end %>

  </div> <!--/col-sm-12-->
</div>


<div id="myModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content"></div>
  </div>
</div>
